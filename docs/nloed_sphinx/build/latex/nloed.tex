%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english,openany,oneside]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{2}



\title{NLoed}
\date{Jan 20, 2021}
\release{0.0.1}
\author{Nathan Braniff}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}



\chapter{NLoed’s Model Class}
\label{\detokenize{nloed:module-nloed.model}}\label{\detokenize{nloed:nloed-s-model-class}}\label{\detokenize{nloed::doc}}\index{module@\spxentry{module}!nloed.model@\spxentry{nloed.model}}\index{nloed.model@\spxentry{nloed.model}!module@\spxentry{module}}\index{Model (class in nloed.model)@\spxentry{Model}\spxextra{class in nloed.model}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{nloed.model.}}\sphinxbfcode{\sphinxupquote{Model}}}{\emph{\DUrole{n}{observ\_struct}}, \emph{\DUrole{n}{input\_names}}, \emph{\DUrole{n}{param\_names}}, \emph{\DUrole{n}{options}\DUrole{o}{=}\DUrole{default_value}{\{\}}}}{}
Bases: \sphinxcode{\sphinxupquote{object}}

The NLoed Model class implements a mathematical model and provides useful functions for model building.

This class encodes casadi symbolic structures connecting model inputs and parameters to the
observation variables. The class also encodes the assumed distirbution for each model observation
variable.

Upon construction, the class populates a series of casadi function attributes for
computing various model predictions (i.e. mean, variance, sensitivity), logliklhoods, data
sampling, and the fisher information. These function attributes are used to implement the class’s
public user\sphinxhyphen{}callable functions; fit(), predict(), evaluate() and sample(). The function attributes
are also used by NLoed’s Design class when a Model instance is passsed for experimental design.
\index{symbolics\_boolean (nloed.model.Model attribute)@\spxentry{symbolics\_boolean}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.symbolics_boolean}}\pysigline{\sphinxbfcode{\sphinxupquote{symbolics\_boolean}}}
A boolean indicating if Casadi SX (True) or MX (false) symbolics
should be used.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{num\_observ (nloed.model.Model attribute)@\spxentry{num\_observ}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.num_observ}}\pysigline{\sphinxbfcode{\sphinxupquote{num\_observ}}}
An integer indicating the number of observation variables in the model.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
integer

\end{description}\end{quote}

\end{fulllineitems}

\index{num\_input (nloed.model.Model attribute)@\spxentry{num\_input}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.num_input}}\pysigline{\sphinxbfcode{\sphinxupquote{num\_input}}}
An integer indicating the number of input variables accepted by the model.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
integer

\end{description}\end{quote}

\end{fulllineitems}

\index{num\_param (nloed.model.Model attribute)@\spxentry{num\_param}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.num_param}}\pysigline{\sphinxbfcode{\sphinxupquote{num\_param}}}
An integer indicating the number of parameters accepted by the model.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
integer

\end{description}\end{quote}

\end{fulllineitems}

\index{input\_name\_list (nloed.model.Model attribute)@\spxentry{input\_name\_list}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.input_name_list}}\pysigline{\sphinxbfcode{\sphinxupquote{input\_name\_list}}}
A list of the input variable names, in the order passed
to the model constructor.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
list of strings

\end{description}\end{quote}

\end{fulllineitems}

\index{param\_name\_list (nloed.model.Model attribute)@\spxentry{param\_name\_list}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.param_name_list}}\pysigline{\sphinxbfcode{\sphinxupquote{param\_name\_list}}}
A list of the parameter names, in the order passed
to the model constructor.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
list of strings

\end{description}\end{quote}

\end{fulllineitems}

\index{observ\_name\_list (nloed.model.Model attribute)@\spxentry{observ\_name\_list}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.observ_name_list}}\pysigline{\sphinxbfcode{\sphinxupquote{observ\_name\_list}}}
A list of the observation variable names, in the order
passed to the model constructor.
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
list of strings

\end{description}\end{quote}

\end{fulllineitems}

\index{loglik (nloed.model.Model attribute)@\spxentry{loglik}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.loglik}}\pysigline{\sphinxbfcode{\sphinxupquote{loglik}}}
This function attribute consists of a dictionary in which
the keys are the model’s observation variable names and the values are casadi functions
computing the loglikelihood of a single observation of the variable at the passed
observation value with the passed input and parameter settings.

Call Structure: Model.loglik{[}obs\_name{]}(obs\_value, inputs, parameters)
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
dictionary of functions

\end{description}\end{quote}

\end{fulllineitems}

\index{fisher\_info\_matrix (nloed.model.Model attribute)@\spxentry{fisher\_info\_matrix}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.fisher_info_matrix}}\pysigline{\sphinxbfcode{\sphinxupquote{fisher\_info\_matrix}}}
This function attribute consists of a
dictionary in which the keys are the model’s observation variable names and the values
are casadi functions computing the fisher information matrix for a single observation of
the specified observation variable at the passed input and parameter settings.
Model.model\_mean(inputs, parameters)

Call Structure: Model.fisher\_info\_matrix{[}obs\_name{]}(inputs, parameters)
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
dictionary of functions

\end{description}\end{quote}

\end{fulllineitems}

\index{model\_mean (nloed.model.Model attribute)@\spxentry{model\_mean}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.model_mean}}\pysigline{\sphinxbfcode{\sphinxupquote{model\_mean}}}
This function attribute consists of a
dictionary in which the keys are the model’s observation variable names and the values
are casadi functions computing the expected mean observation value at the passed input
and parameter settings.

Call Structure: Model.model\_mean{[}obs\_name{]}(inputs, parameters)
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
dictionary of functions

\end{description}\end{quote}

\end{fulllineitems}

\index{model\_variance (nloed.model.Model attribute)@\spxentry{model\_variance}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.model_variance}}\pysigline{\sphinxbfcode{\sphinxupquote{model\_variance}}}
This function attribute consists of a
dictionary in which the keys are the model’s observation variable names and the values
are casadi functions computing the expected variance of the observation variable at the
passed input and parameter settings.

Call Structure: Model.model\_variance{[}obs\_name{]}(inputs, parameters)
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
dictionary of functions

\end{description}\end{quote}

\end{fulllineitems}

\index{model\_sensitivity (nloed.model.Model attribute)@\spxentry{model\_sensitivity}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.model_sensitivity}}\pysigline{\sphinxbfcode{\sphinxupquote{model\_sensitivity}}}
This function attribute consists of a
dictionary in which the keys are the model’s observation variable names and the values
are casadi functions computing the parameteric sensitivity of the expected mean
observation of the specified variable at the passed input and parameter settings.

Call Structure: Model.model\_variance{[}obs\_name{]}(inputs, parameters)
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
dictionary of functions

\end{description}\end{quote}

\end{fulllineitems}

\index{observation\_sampler (nloed.model.Model attribute)@\spxentry{observation\_sampler}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.observation_sampler}}\pysigline{\sphinxbfcode{\sphinxupquote{observation\_sampler}}}
This function attribute consists of a
dictionary in which the keys are the model’s observation variable names and the values
are casadi\sphinxhyphen{}based functions generating random realizations of the observation variable value
from its expected distribution, conditioned on the passed input and parameter settings.

Call Structure: Model.model\_variance{[}obs\_name{]}(inputs, parameters)
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
dictionary of functions

\end{description}\end{quote}

\end{fulllineitems}

\index{observation\_percentile (nloed.model.Model attribute)@\spxentry{observation\_percentile}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.observation_percentile}}\pysigline{\sphinxbfcode{\sphinxupquote{observation\_percentile}}}
This function attribute consists of a
dictionary in which the keys are the model’s observation variable names and the values
are casadi\sphinxhyphen{}based functions computing the requested percentile of the observation variable’s
distribution conditioned on the passed input and parameter settings.

Call Structure: Model.model\_variance{[}obs\_name{]}(percentile, inputs, parameters)
\begin{quote}\begin{description}
\item[{Type}] \leavevmode
dictionary of functions

\end{description}\end{quote}

\end{fulllineitems}

\index{distribution\_dict (nloed.model.Model attribute)@\spxentry{distribution\_dict}\spxextra{nloed.model.Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.distribution_dict}}\pysigline{\sphinxbfcode{\sphinxupquote{distribution\_dict}}\sphinxbfcode{\sphinxupquote{ = \{\textquotesingle{}Bernoulli\textquotesingle{}: {[}\textquotesingle{}Probability\textquotesingle{}{]}, \textquotesingle{}Binomial\textquotesingle{}: {[}\textquotesingle{}Probability\textquotesingle{}{]}, \textquotesingle{}Exponential\textquotesingle{}: {[}\textquotesingle{}Rate\textquotesingle{}{]}, \textquotesingle{}Gamma\textquotesingle{}: {[}\textquotesingle{}Shape\textquotesingle{}, \textquotesingle{}Scale\textquotesingle{}{]}, \textquotesingle{}Lognormal\textquotesingle{}: {[}\textquotesingle{}GeoMean\textquotesingle{}, \textquotesingle{}GeoVariance\textquotesingle{}{]}, \textquotesingle{}Normal\textquotesingle{}: {[}\textquotesingle{}Mean\textquotesingle{}, \textquotesingle{}Variance\textquotesingle{}{]}, \textquotesingle{}Poisson\textquotesingle{}: {[}\textquotesingle{}Rate\textquotesingle{}{]}\}}}}
\end{fulllineitems}

\index{fit() (nloed.model.Model method)@\spxentry{fit()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.fit}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{fit}}}{\emph{\DUrole{n}{datasets}}, \emph{\DUrole{n}{start\_param}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{options}\DUrole{o}{=}\DUrole{default_value}{\{\}}}}{}
A function for fitting the NLoed model to a dataset contained in a dataframe.

This function fits the model to a dataset using maximum likelihood. This function can also
return marginal confidence intervals as well as plots of liklihood profiles and projections
of profiles traces and confidence contours.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{datasets}} (\sphinxstyleliteralemphasis{\sphinxupquote{dataframe OR list of dataframes}}) \textendash{} A dataframe containing the dataset to be fit.
OR a list of dataframes, each containing a dataset replicate of a given design
OR a list of lists of dataframes, where each index in the outer list corresponds
to a unique design and each inner index coresponds to a replicate of the given design

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{start\_param}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} An array of starting parameter values where the
local fitting optimization should be started

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{options}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} 
A dictionary of user\sphinxhyphen{}defined options, possible key\sphinxhyphen{}value pairs
include:

”Confidence” \textendash{}
Purpose: Determines confidnece diagnostics to be returned or plotted,
Type: string,
Default Value: “None”,
Possible Values:
“None” = No intervals returned,
“Intervals” = Marginal intervals returned,
“Profiles” = Same as “Intervals” but trace projections are plotted using Matplotlib,
“Contours” = Same as  “Profiles” but confidence contour projections are also plotted.

”ConfidenceLevel” \textendash{}
Purpose: Sets the confidence level for the marginal intervals, traces, profiles and contours,
Type: float,
Default Value: 0.95,
Possible Values: 0\textless{}1.

’RadialNumber’ \textendash{}
Purpose: Determines the number of radial searches performed out from the fit
parameter value used to find the confidence contour projections,
Type: integer
Default Value: 30
Possible Values: \textgreater{}1, but sufficient density is needed for good interpolation

”SampleNumber” \textendash{}
Purpose:
Type: integer
Default Value: 10
Possible Values: \textgreater{}1

”Tolerance” \textendash{}
Purpose:
Type: float
Default Value: 0.001
Possible Values: \textgreater{}0

”InitialStep” \textendash{}
Purpose:
Type: float
Default Value: 0.01
Possible Values: \textgreater{}0

”MaxSteps” \textendash{}
Purpose:
Type: integer
Default Value: 2000
Possible Values: \textgreater{}1

”SearchFactor” \textendash{}
Purpose:
Type: float
Default Value: 5.0
Possible Values: \textgreater{}0

”InitParamBounds” \textendash{}
Purpose:
Type: array\sphinxhyphen{}like
Default Value: False
Possible Values:

”InitSearchNumber” \textendash{}
Purpose:
Type: integer
Default Value: 3
Possible Values: \textgreater{}0

”Verbose” \textendash{}
Purpose:
Type: boolean
Default Value: True
Possible Values: True or False


\end{itemize}

\item[{Returns}] \leavevmode
A dataframe containing the fit parameters,
and if requested, confidence interval information. If a list of datasets was provided,
each row of the dataframe corresponds to the dataset index in the passed list.
If a list of lists of dataframes was provided (designs by replicates),
a list of dataframes will be returned with the same length as the outer index of the
passed list of lists.

\item[{Return type}] \leavevmode
dataframe OR list of dataframes

\end{description}\end{quote}

\end{fulllineitems}

\index{sample() (nloed.model.Model method)@\spxentry{sample()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.sample}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{sample}}}{\emph{\DUrole{n}{designs}}, \emph{\DUrole{n}{param}}, \emph{\DUrole{n}{design\_replicates}\DUrole{o}{=}\DUrole{default_value}{1}}, \emph{\DUrole{n}{options}\DUrole{o}{=}\DUrole{default_value}{\{\}}}}{}
A function for generating simulated data from the NLoed model for a given design passed
as a dataframe.

This function generates datasets using the NLoed model and a provided design (or a list of
designs) via simulation and Numpy/Scipy’s random number generation. This simulation is done
at a user\sphinxhyphen{}provided set of parameter values. The number of replicates of the design that are
simulated is optional but defaults to one.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{designs}} (\sphinxstyleliteralemphasis{\sphinxupquote{dataframe OR list of dataframes}}) \textendash{} A dataframe containing the design to be simulated,
OR a list of dataframes containing multiple designs to be simulated

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{param}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{floats}}) \textendash{} The parameter values used to generate the data

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{design\_replicates}} (\sphinxstyleliteralemphasis{\sphinxupquote{integer}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} An integer indicating the number of dataset
replicates to be generated for each design. The default is 1 per design passed.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{options}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} 
A dictionary of user\sphinxhyphen{}defined options, possible key\sphinxhyphen{}value pairs
include:

”Verbose” \textendash{}
Purpose: Determines the amount of print feedback provided while the function executes
Type: bool,
Default Value: True,
Possible Values: True or False


\end{itemize}

\item[{Returns}] \leavevmode
A dataframe containg a simulation of the design is returned by default
OR, if design\_replicates was set to \textgreater{}1, a list of dataframes containg simulated
replicates is returned for the given design
OR,  if a list of dataframes containing a set of design was passed,
a list of lists of dataframes is returned, the outer index corresponds to the design
list, and the inner index corresponds to the number of replicates requested.

\item[{Return type}] \leavevmode
dataframe OR list of dataframes

\end{description}\end{quote}

\end{fulllineitems}

\index{predict() (nloed.model.Model method)@\spxentry{predict()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.predict}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{predict}}}{\emph{\DUrole{n}{input\_struct}}, \emph{\DUrole{n}{param}}, \emph{\DUrole{n}{covariance\_matrix}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{options}\DUrole{o}{=}\DUrole{default_value}{\{\}}}}{}
A function for generating prediction information from the NLoed model.

This function can be used to compute predictions from an NLoed model instance given the
user\sphinxhyphen{}provided input conditions and paramater values. Prediction information includes the
predicted mean response of the model, confidence intervals for the mean response under
parameter uncertainty, confidence intervals for the observation distribution, and sensitivity
analysis of the mean response. The returned intervals can be computed in a number of ways;
exactly, with a normal (local and deterministic) approximation, or using Monte Carlo simulation.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{input\_struct}} (\sphinxstyleliteralemphasis{\sphinxupquote{dataframe}}) \textendash{} A dataframe specifying the combination of inputs values and
observations at which predictions are desired.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{param}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{floats}}) \textendash{} The parameter vector values at which the predictions are to be made.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{covariance\_matrix}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{floats}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} A symetric matrix specifying the parameter’s
normal covariance matrix, required if parameter uncertainty is to be included. The
prior mean set by the values passed via the param argument.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{options}} (\sphinxstyleliteralemphasis{\sphinxupquote{dictionary}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} 
A dictionary of user\sphinxhyphen{}defined options, possible key\sphinxhyphen{}value
pairs include:

”Method” \textendash{}
Purpose: Selects the method used to compute the mean and prediction and observation
intervals.
Type: string
Default Value: “Delta”
Possible Values: “Exact”=Compute predictions and intervals exactly; this
option is only available if no parameter uncertainty information is NOT provided .
“Delta”=Use a normal, local apporximation to compute the prediction and
intervals, “MonteCarlo”=Use Monte Carlo simulation of the model to compute the
prediction and intervals under any parameter or observation uncertainty.

”PredictionInterval” \textendash{}
Purpose: A boolean to indicat if prediction intervals are to be returned, true if yes.
Type: bool
Default Value: False
Possible Values: True or False

”ObservationInterval” \textendash{}
Purpose: A boolean to indicat if observation intervals are to be returned, true if yes.
Type: bool
Default Value: False
Possible Values: True or False

”Sensitivity” \textendash{}
Purpose: A boolean to indicat if observation intervals are to be returned, true if yes.
Type: bool
Default Value: False
Possible Values: True or False

”PredictionSampleNumber” \textendash{}
Purpose: An integer indicating the number of parameter vectors to be sampled from
the prior in order to compute the prediction (and observation0 intervals using Monte
Carlo simulation.
Type: integer
Default Value: 10000
Possible Values:

”ObservationSampleNumber” \textendash{}
Purpose: An integer indicating the number of observation values to be sampled from
the observation distribution in order to compute the observation interval using
Monte Carlo simulation.
Type: integer
Default Value: 10
Possible Values:

”ConfidenceLevel” \textendash{}
Purpose: A float specifying the confidence level desired for any intervals computed.
Type: float
Default Value: 0.95
Possible Values: \textless{}1, \textgreater{}0


\end{itemize}

\item[{Returns}] \leavevmode
\begin{description}
\item[{A dataframe containing the requested prediction quntities computed at the}] \leavevmode
input and parameter settings passed.

\end{description}


\item[{Return type}] \leavevmode
dataframe

\end{description}\end{quote}

\end{fulllineitems}

\index{evaluate() (nloed.model.Model method)@\spxentry{evaluate()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.evaluate}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{evaluate}}}{\emph{\DUrole{n}{designs}}, \emph{\DUrole{n}{param}}, \emph{\DUrole{n}{options}\DUrole{o}{=}\DUrole{default_value}{\{\}}}}{}~\begin{description}
\item[{A function for evaluating the peformance metrics of an experimental design applied to}] \leavevmode
the NLoed Model.

\end{description}

This function can be used to produce evaluation metrics regarding the expected parameter
fitting accurach a given experimental design will achieve when used with the given NLoed
Model instance.

Evaluation metrics inclide the expected parameter covariance, bias and mean
squared error as well as the Fisher information matrix. These metrics can be computed either
asymptoticall (i.e. via the Fisher information matrix; in this case the bias is zero and the
covariance and MSE are equal) or using Monte Carlo simulation and fitting (in which case the
bias, covariance and MSE may be unique). By default this function only returns the parameter
covariance for the design, computed asymptoticall.

All evaluation is performed at the candidate parameter vector passed, and as such these
metrics are only local appoximations valid near the candidate point.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{designs}} (\sphinxstyleliteralemphasis{\sphinxupquote{dataframe OR list of dataframes}}) \textendash{} A dataframe specifying the experimental design
to be evaluated,
OR a list of dataframes describing a set ofexperimental designs to be evaluated.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{param}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{floats}}) \textendash{} The parameter vector values at which the predictions are to be made.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{options}} (\sphinxstyleliteralemphasis{\sphinxupquote{dictionary}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} 
A dictionary of user\sphinxhyphen{}defined options, possible key\sphinxhyphen{}value
pairs include:

”Method” \textendash{}
Purpose: A string indicating which computational method, asymptotic or Monte Carlo,
is used to compute the evaluation metrics.
Type: string
Default Value: “Asymptotic
Possible Values: “Asymptotic”=Uses a first\sphinxhyphen{}order approximation based onvthe FIM
matrix to compute the parameter covariance; bias is zero. “MonteCarlo”= Uses
repeated data simulation and fitting to compute the evaluation metrics.

”Covariance” \textendash{}
Purpose: A boolean value indicating if the parameter covariance matrix should be
computed and returned, true implies yes.
Type: boolean
Default Value: True
Possible Values: True or False

”Bias” \textendash{}
Purpose: A boolean value indicating if the parameter bias vector should be
computed and returned, true implies yes.
Type: boolean
Default Value: False
Possible Values: True or False

”MSE” \textendash{}
Purpose: A boolean value indicating if the parameter mean squated error vector
should be computed and returned, true implies yes.
Type: boolean
Default Value: False
Possible Values: True or False

”FIM” \textendash{}
Purpose: A boolean value indicating if the Fisher information matrix
should be computed and returned, true implies yes.
Type: boolean
Default Value: False
Possible Values: True or False

”SampleNumber” \textendash{}
Purpose: An integer indicating the number of simulations of the experimental design,
and subsequent fittings, that should be performed if the Monte Carlo method is used
to compute the evaluation metrics.
Type: integer
Default Value: 1000
Possible Values: \textgreater{}0, must be large enough for a statistically stable estimate


\end{itemize}

\item[{Returns}] \leavevmode
A dataframe containg the design evaluation metrics,
OR if a list of design dataframes was passed, a list of dataframes is returned
each containing the design evaluation metrics for its corresponding design.

\item[{Return type}] \leavevmode
dataframe

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_get\_distribution\_functions() (nloed.model.Model method)@\spxentry{\_\_get\_distribution\_functions()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.__get_distribution_functions}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_get\_distribution\_functions}}}{\emph{\DUrole{n}{observ\_model}}, \emph{\DUrole{n}{observ\_distribution}}}{}
A private function that automatically generates function attributes for the provided
observation variable information.

This private function is used during the NLoed Model class construction.

This function accepts the observation name, distribution type
and observation model and constructs casadi functions to compute
the logliklihood, fisher information, prediction mean/sensitivity/variance
and also a numpy/casadi function to return random samples from the the model
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{observ\_model}} \textendash{} A symbolic Casadi function mapping the model input and parameter vectors
to the observation distribution statistics.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{observ\_distribution}} (\sphinxstyleliteralemphasis{\sphinxupquote{string}}) \textendash{} A string specifying the observation distribution type,
must be one of the supported distributions.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{description}
\item[{A list of Casadi(\sphinxhyphen{}based) functions in the following order;}] \leavevmode
loglikelihood, fisher information, observation mean , observation variance,
mean sensitivity, observation sampler, observation percentile

\end{description}


\item[{Return type}] \leavevmode
list of functions

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_confidence\_intervals() (nloed.model.Model method)@\spxentry{\_\_confidence\_intervals()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.__confidence_intervals}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_confidence\_intervals}}}{\emph{\DUrole{n}{mle\_params}}, \emph{\DUrole{n}{loglik\_func}}, \emph{\DUrole{n}{options}}}{}
A private helper function for computing parameter confidence intervals.

This private function is used in some calls to the public Model.fit() function and is
triggered by a user call after instantiation.

This function computes marginal parameter confidence intervals for the model
around the MLE estimate using profile likelihoods.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{mle\_params}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{floats}}) \textendash{} A vector specifying the MLE parameter estimates generated and
passed during a call to Model.fit().

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{loglik\_func}} \textendash{} A Casadi function for computing the total data log\sphinxhyphen{}likelihood for the
current dataset being handled within the calling Model.fit() call. The only argument
is a putative parameter vector.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{options}} (\sphinxstyleliteralemphasis{\sphinxupquote{dictionary}}) \textendash{} A dictionary of user\sphinxhyphen{}defined options encoded as key\sphinxhyphen{}value
pairs. This dictionary is passed through from a call to Model.fit(), see
the fit() functions documentation for possible key\sphinxhyphen{}value pairs.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{description}
\item[{A list of lists, the outer index corresponds to each parameter coordinate,}] \leavevmode
the innder list contains both the upper and lower bounds for each parameter.

\end{description}


\item[{Return type}] \leavevmode
list of lists

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_profile\_plot() (nloed.model.Model method)@\spxentry{\_\_profile\_plot()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.__profile_plot}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_profile\_plot}}}{\emph{\DUrole{n}{mle\_params}}, \emph{\DUrole{n}{loglik\_func}}, \emph{\DUrole{n}{figure}}, \emph{\DUrole{n}{options}}}{}
A private helper function for plotting both the profile likelihoods and the projections
of the profiles traces.

This private function is used in some calls to the public Model.fit() function and is
triggered by a user call after instantiation.

This function generates a square grid of Matplotlib sub\sphinxhyphen{}plots, with a row and column for each
parameter. The logelikelihood profiles of each parameter are plotted on sub\sphinxhyphen{}plots along the
diagonal. These diganol plots also include a horizantal reference line indicating
loglikleihood value at which the perscribed confidence level boundaries occur. Projections
of the profile likelihood traces for each pair of parameters value are plotted on the lower
triangular sub\sphinxhyphen{}plots. This function also returns lists containing the computed intervals,
traces and profiles.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{mle\_params}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{floats}}) \textendash{} A vector specifying the MLE parameter estimates generated and
passed during a call to Model.fit().

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{loglik\_func}} (\sphinxstyleliteralemphasis{\sphinxupquote{function}}) \textendash{} A Casadi function for computing the total data log\sphinxhyphen{}likelihood
for the current dataset being handled within the calling Model.fit() call. The only
argument is a putative parameter vector.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{figure}} (\sphinxstyleliteralemphasis{\sphinxupquote{integer}}) \textendash{} The figure object handle on which the plot is generated.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{options}} (\sphinxstyleliteralemphasis{\sphinxupquote{dictionary}}) \textendash{} A dictionary of user\sphinxhyphen{}defined options encoded as key\sphinxhyphen{}value
pairs. This dictionary is passed through from a call to Model.fit(), see
the fit() functions documentation for possible key\sphinxhyphen{}value pairs.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{description}
\item[{A multi\sphinxhyphen{}level list of lists is returned, the outer list contains three elements;}] \leavevmode
1 \sphinxhyphen{} a list of lists where the outer index corresponds to each parameter and the
inner list contains the upper and lower confidence interval bounds for each parameter,
2 \sphinxhyphen{} a list of list of lists where the outer index corresponds to each parameter and
the middle index corresponds to points along each profile trace and the inner list
contains the value of the parameter vector at that point in the parameter trace.
3 \sphinxhyphen{} a ;ist of lists where the outer index corresponds to each parameter value and
the inner index corresponds to logliklihood ratio values for the given parameter
at points along the likelihood profile. Note this return is passed up from a call
to \_\_profile\_trace()

\end{description}


\item[{Return type}] \leavevmode
nested lists

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_profile\_trace() (nloed.model.Model method)@\spxentry{\_\_profile\_trace()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.__profile_trace}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_profile\_trace}}}{\emph{\DUrole{n}{mle\_params}}, \emph{\DUrole{n}{loglik\_func}}, \emph{\DUrole{n}{options}}}{}
A private helper function for computing the likelihood profile and trace for each
parameter.

This private function is used in some calls to the public Model.fit() function and is
triggered by a user call after instantiation.

This function accepts the MLE parameter estimate and a Casadi function for the total data
log\sphinxhyphen{}likelihood of the target dataset being processed by the current Model.fit() call
and uses this to organize computation of a profile likelihood and the corresponding
parameter vector trace along the computed profile, for each parameter. In the
course of the this computation, this function also computes the likelihood confidence
intervals for each parameter as well. This function organizes the profile computation for
each parameter and in both increasing and decreasing directions, however it relies on lower
level helper functions (\_\_loglik\_search and \_\_profile\_setup) to do the actual computing.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{mle\_params}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{floats}}) \textendash{} A vector specifying the MLE parameter estimates generated and
passed during a call to Model.fit().

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{loglik\_func}} (\sphinxstyleliteralemphasis{\sphinxupquote{function}}) \textendash{} A Casadi function for computing the total data log\sphinxhyphen{}likelihood
for the current dataset being handled within the initating Model.fit() call. The only
argument is a putative parameter vector.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{options}} (\sphinxstyleliteralemphasis{\sphinxupquote{dictionary}}) \textendash{} A dictionary of user\sphinxhyphen{}defined options encoded as key\sphinxhyphen{}value
pairs. This dictionary is passed through from a call to Model.fit(), see
the fit() functions documentation for possible key\sphinxhyphen{}value pairs.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{description}
\item[{A multi\sphinxhyphen{}level list of lists is returned, the outer list contains three elements;}] \leavevmode
1 \sphinxhyphen{} a list of lists where the outer index corresponds to each parameter and the
inner list contains the upper and lower confidence interval bounds for each parameter,
2 \sphinxhyphen{} a list of list of lists where the outer index corresponds to each parameter and
the middle index corresponds to points along each profile trace and the inner list
contains the value of the parameter vector at that point in the parameter trace.
3 \sphinxhyphen{} a ;ist of lists where the outer index corresponds to each parameter value and
the inner index corresponds to logliklihood ratio values for the given parameter
at points along the likelihood profile.

\end{description}


\item[{Return type}] \leavevmode
nested lists

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_contour\_plot() (nloed.model.Model method)@\spxentry{\_\_contour\_plot()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.__contour_plot}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_contour\_plot}}}{\emph{\DUrole{n}{mle\_params}}, \emph{\DUrole{n}{loglik\_func}}, \emph{\DUrole{n}{figure}}, \emph{\DUrole{n}{options}}}{}
A private helper function for plotting the likelihood confidence contour plots during
calls to Model.fit()

This private function is used in some calls to the public Model.fit() function and is
triggered by a user call after instantiation.

This function plots the projections of the profile likelihood\sphinxhyphen{}based confidence volume in a
2d plane for each pair of parameters using Matplotlib. This creates marginal confidence
contours for each pair of parameters which are added to the trace projection plots generated
by \_\_profile\_plot() in the lower\sphinxhyphen{}triangualr sub\sphinxhyphen{}plots of the passed figure.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{mle\_params}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{floats}}) \textendash{} A vector specifying the MLE parameter estimates generated and
passed during a call to Model.fit().

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{loglik\_func}} (\sphinxstyleliteralemphasis{\sphinxupquote{function}}) \textendash{} A Casadi function for computing the total data log\sphinxhyphen{}likelihood
for the current dataset being handled within the calling Model.fit() call. The only
argument is a putative parameter vector.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{figure}} (\sphinxstyleliteralemphasis{\sphinxupquote{integer}}) \textendash{} The figure object handle on which the plot is generated.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{options}} (\sphinxstyleliteralemphasis{\sphinxupquote{dictionary}}) \textendash{} A dictionary of user\sphinxhyphen{}defined options encoded as key\sphinxhyphen{}value
pairs. This dictionary is passed through from a call to Model.fit(), see
the fit() functions documentation for possible key\sphinxhyphen{}value pairs.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_contour\_trace() (nloed.model.Model method)@\spxentry{\_\_contour\_trace()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.__contour_trace}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_contour\_trace}}}{\emph{\DUrole{n}{mle\_params}}, \emph{\DUrole{n}{loglik\_func}}, \emph{\DUrole{n}{coordinates}}, \emph{\DUrole{n}{options}}}{}
A private helper function for computing the profile likelihood confidence contour
projections for a specified pair of parameters.

This private function is used in some calls to the public Model.fit() function and is
triggered by a user call after instantiation.

This function computes a projection boundary of the profile likelihood confidence volume in
a 2D plane for the specified pair of parameters. To do this a series of vectors radiating
out from the MLE in the target parameter pair plane are searched. Along these vectors the
marginal (non\sphinxhyphen{}target\sphinxhyphen{}pair) parameters are re\sphinxhyphen{}optimized iteratively. The vectors are extended
until the conditionally optimized value of the likelihood falls below the selected confidence
threshold. The 2D coordinates of these boundary points are recorded and their values are used
to interpolate the projected confidence boundary via a periodic spline. This function
sets up the radial search and performs the interpolation but relies on lower level helper
functions (\_\_profile\_setup and \_\_loglik\_search) to compute the boundary points.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{mle\_params}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{floats}}) \textendash{} A vector specifying the MLE parameter estimates generated and
passed during a call to Model.fit().

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{loglik\_func}} (\sphinxstyleliteralemphasis{\sphinxupquote{function}}) \textendash{} A Casadi function for computing the total data log\sphinxhyphen{}likelihood
for the current dataset being handled within the calling Model.fit() call. The only
argument is a putative parameter vector.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{coordinates}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{integers}}) \textendash{} A pair of parameter indices specifying the specific
parameter pair for which a two 2D contour is to be computed in parameter space.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{options}} (\sphinxstyleliteralemphasis{\sphinxupquote{dictionary}}) \textendash{} A dictionary of user\sphinxhyphen{}defined options encoded as key\sphinxhyphen{}value
pairs. This dictionary is passed through from a call to Model.fit(), see
the fit() functions documentation for possible key\sphinxhyphen{}value pairs.

\end{itemize}

\item[{Returns}] \leavevmode
A list of lists is returned, where the outer list contains two entries;
a list of x coorindates followed by a list of y coordinates. The coordinates fall on
the contour projection in the 2D target parameter pair plane. The number of of x and y
coordinates is equal and is set by the “RadialNumber” key in Model.fit()’s options
dictionary.

\item[{Return type}] \leavevmode
list of lists

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_profile\_setup() (nloed.model.Model method)@\spxentry{\_\_profile\_setup()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.__profile_setup}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_profile\_setup}}}{\emph{\DUrole{n}{mle\_params}}, \emph{\DUrole{n}{loglik\_func}}, \emph{\DUrole{n}{fixed\_params}}, \emph{\DUrole{n}{direction}}, \emph{\DUrole{n}{options}}}{}
A private helper function for constructing profile likelihood optimization solvers.

This private function is used in some calls to the public Model.fit() function and is
triggered by a user call after instantiation.

This function creates a Casadi optimization solver object for optimizing the model’s
likelihood (on the target dataset of the iniating Model.fit() call) w.r.t. the marginal
parameter values while holding a specific subset of parameters fixed at specified values.

There can be a single fixed parameter (for the common profile likelihood computations), or a set
(currently we only ever need a pair, used for computing confidence contour projections in 2D).
The fixed parameter values are specified by a radius and direction vector which makes it
easy to perform radial searches required for the confidence contour trace (the optimizer is
iteratively run with different radia values in order to find the boundary points). The
direction vector is hard\sphinxhyphen{}coded into the resulting solver object after a call to
\_\_profile\_setup() but the radius can be adjust (hence moving the ‘fixed’ parameters) when
the solver object is actually run for optimization. This alterable radius value
enables the actual profile likelihood search.

The solver object actually optimizes the loglikelihood ratio (LLR) gap, the likelihood ratio
gap is the negative difference between the chi\sphinxhyphen{}squared boundary (specified by the user in
the initiating call to Model.fit()) and the loglikelihood ratio at the current marginal
parameter vector being optimized. This is just a rezeroing of the scale and is equivlant to
optimizing the loglikelihood but makes some of the numerics and output more convenient to
manage.

Note that limited testing has been done on single parameter models however the resulting
return object for a 1D model should behave like a regular solver but actually just returns
the LLR gap value at the radius\sphinxhyphen{}specified fixed values of the lone parameter.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{mle\_params}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{floats}}) \textendash{} A vector specifying the MLE parameter estimates generated and
passed during a call to Model.fit().

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{loglik\_func}} (\sphinxstyleliteralemphasis{\sphinxupquote{function}}) \textendash{} A Casadi function for computing the total data log\sphinxhyphen{}likelihood
for the current dataset being handled within the calling Model.fit() call. The only
argument is a putative parameter vector.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{fixed\_params}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{booleans}}) \textendash{} A boolean vector that is the same length as the
model’s parameter vector. True values imply the cooresponding parameter (by position)
should remain fixed in the solver object by the provideddirection and radius,
False values indicate the corresponding parameter is marginal and should optimized.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{direction}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{floats}}) \textendash{} A vector that is the same length as the parameter vector
specifying a direction in parameter space. Coordinate specified as True (non\sphinxhyphen{}marginal)
in the fixed\_params argument are used as the direction (along which the solver’s
run\sphinxhyphen{}time radius argument specifies the value of the fixed parameters)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{options}} (\sphinxstyleliteralemphasis{\sphinxupquote{dictionary}}) \textendash{} A dictionary of user\sphinxhyphen{}defined options encoded as key\sphinxhyphen{}value
pairs. This dictionary is passed through from a call to Model.fit(), see
the fit() functions documentation for possible key\sphinxhyphen{}value pairs.

\end{itemize}

\item[{Returns}] \leavevmode
A Casadi Ipopt solver object is returned, which can optimize the
loglikelihood ratio gap w.r.t. the marginal parameter values, conditioned on the fixed
parmeter value which are specified by a radius (set at call time) and direction (set in
\_\_profile\_setup() above when the solver is created).

\item[{Return type}] \leavevmode
casadi solver

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_logliksearch() (nloed.model.Model method)@\spxentry{\_\_logliksearch()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.__logliksearch}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_logliksearch}}}{\emph{\DUrole{n}{profile\_loglik\_solver}}, \emph{\DUrole{n}{marginal\_param}}, \emph{\DUrole{n}{options}}, \emph{\DUrole{n}{forward}\DUrole{o}{=}\DUrole{default_value}{True}}}{}
A private helper function for performing a bisection search for profile likelihood
boundary points.

This private function is used in some calls to the public Model.fit() function and is
triggered by a user call after instantiation.

This function performs a root finding algorithm using the solver object  (profile\_loglik\_solver)
generated by \_\_profile\_setup(). Currently the function uses a bisection search. The search
is performed along the direction vector specified when the solve object is created by
\_\_profile\_setup(), with the given set of fixed and marginal parameters specified in that
call. The search dimensions is the radius argument of the solver object, which specified when
combined with the direction vector hard\sphinxhyphen{}coded in the solver object to specify its magnuted,
resulst in a specific set of fixed parmaeter values at which the conditional likelihood
optimization is performed. The radius at which a root is found indicates a boundary point in
the confidence volume at the confidence level specified by the use in their initating call to
\begin{quote}

Model.fit().
\end{quote}

Note a passed version used Halley’s method; a higher order extension of Newton’s method for
finding roots. This was possible using Casadi’s ability to differentiate optimization solutions
and was faster, but proved to be numerically unstable.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{profile\_loglik\_solver}} \textendash{} The Casadi Ipopt solver object functions for finding the conditionally
optimized loglikelihood ratio gap at a given radius from MLE. This object is generated
with a call to \_\_profile\_setup().

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{marginal\_param}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{floats}}) \textendash{} The starting values (usually the MLE) for the
marginal parameters that are passed to the Ipopt solver.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{options}} (\sphinxstyleliteralemphasis{\sphinxupquote{dictionary}}) \textendash{} A dictionary of user\sphinxhyphen{}defined options encoded as key\sphinxhyphen{}value
pairs. This dictionary is passed through from a call to Model.fit(), see
the fit() functions documentation for possible key\sphinxhyphen{}value pairs.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{forward}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolean}}) \textendash{} A boolean indicating the directino of the search, if True the search
is done in the forward (positive) radius direction (relative to direction specidied
in solver object), if False the search is performed starting with a negative radius.

\end{itemize}

\item[{Returns}] \leavevmode
The return object is a three element list, the first entry is  contains the radius
value at which the root was found, the second entry contains a list of the optimzed marginal
parameter values at the root, and the third entry contains the residual value of the LLR
gap at the root (this should be near zero).

\item[{Return type}] \leavevmode
list

\end{description}\end{quote}

\end{fulllineitems}

\index{\_\_creategrid() (nloed.model.Model method)@\spxentry{\_\_creategrid()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model.__creategrid}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_\_creategrid}}}{\emph{\DUrole{n}{input\_candidate\_list}}}{}
\end{fulllineitems}

\index{\_progress\_bar() (nloed.model.Model method)@\spxentry{\_progress\_bar()}\spxextra{nloed.model.Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.model.Model._progress_bar}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_progress\_bar}}}{\emph{\DUrole{n}{iteration}}, \emph{\DUrole{n}{total}}, \emph{\DUrole{n}{prefix}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}\textquotesingle{}}}}{}
Helper function to print progress bar in a looped process
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{iteration}} \textendash{} current iteration in the process

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{total}} \textendash{} total iterations in the process

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{prefix}} \textendash{} prefix string to name process

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\chapter{NLoed’s Design Class}
\label{\detokenize{nloed:module-nloed.design}}\label{\detokenize{nloed:nloed-s-design-class}}\index{module@\spxentry{module}!nloed.design@\spxentry{nloed.design}}\index{nloed.design@\spxentry{nloed.design}!module@\spxentry{module}}\index{Design (class in nloed.design)@\spxentry{Design}\spxextra{class in nloed.design}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.design.Design}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{nloed.design.}}\sphinxbfcode{\sphinxupquote{Design}}}{\emph{\DUrole{n}{models}}, \emph{\DUrole{n}{parameters}}, \emph{\DUrole{n}{objective}}, \emph{\DUrole{n}{discrete\_inputs}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{continuous\_inputs}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{observ\_groups}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{fixed\_design}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{options}\DUrole{o}{=}\DUrole{default_value}{\{\}}}}{}
Bases: \sphinxcode{\sphinxupquote{object}}

A class for experimental designs in the NLoed package
\index{round() (nloed.design.Design method)@\spxentry{round()}\spxextra{nloed.design.Design method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.design.Design.round}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{round}}}{\emph{\DUrole{n}{sample\_size}}, \emph{\DUrole{n}{options}\DUrole{o}{=}\DUrole{default_value}{\{\}}}}{}
This function
Args:
Return:

\end{fulllineitems}

\index{relaxed() (nloed.design.Design method)@\spxentry{relaxed()}\spxextra{nloed.design.Design method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.design.Design.relaxed}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{relaxed}}}{\emph{\DUrole{n}{options}\DUrole{o}{=}\DUrole{default_value}{\{\}}}}{}
This function
Args:
Return:

\end{fulllineitems}

\index{power() (nloed.design.Design method)@\spxentry{power()}\spxextra{nloed.design.Design method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.design.Design.power}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{power}}}{\emph{\DUrole{n}{sample\_size}}, \emph{\DUrole{n}{options}\DUrole{o}{=}\DUrole{default_value}{\{\}}}}{}
This function
Args:
Return:

\end{fulllineitems}

\index{\_optim\_settup() (nloed.design.Design method)@\spxentry{\_optim\_settup()}\spxextra{nloed.design.Design method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.design.Design._optim_settup}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_optim\_settup}}}{\emph{\DUrole{n}{fim\_list}}, \emph{\DUrole{n}{continuous\_symbol\_list}}, \emph{\DUrole{n}{continuous\_lowerbounds}}, \emph{\DUrole{n}{continuous\_upperbounds}}, \emph{\DUrole{n}{continuous\_init}}, \emph{\DUrole{n}{weight\_symbol\_list}}, \emph{\DUrole{n}{weight\_sum}}, \emph{\DUrole{n}{weight\_init}}, \emph{\DUrole{n}{options}}}{}
\end{fulllineitems}

\index{\_weighting\_settup() (nloed.design.Design method)@\spxentry{\_weighting\_settup()}\spxextra{nloed.design.Design method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.design.Design._weighting_settup}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_weighting\_settup}}}{\emph{\DUrole{n}{discrete\_input\_names}}, \emph{\DUrole{n}{discrete\_input\_grid}}, \emph{\DUrole{n}{continuous\_input\_names}}, \emph{\DUrole{n}{continuous\_symbol\_archetypes}}, \emph{\DUrole{n}{fixed\_design}}, \emph{\DUrole{n}{options}}}{}
\end{fulllineitems}

\index{\_discrete\_settup() (nloed.design.Design method)@\spxentry{\_discrete\_settup()}\spxextra{nloed.design.Design method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.design.Design._discrete_settup}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_discrete\_settup}}}{\emph{\DUrole{n}{discrete\_inputs}}, \emph{\DUrole{n}{options}}}{}
This function
Args:
Return:

\end{fulllineitems}

\index{\_continuous\_settup() (nloed.design.Design method)@\spxentry{\_continuous\_settup()}\spxextra{nloed.design.Design method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.design.Design._continuous_settup}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_continuous\_settup}}}{\emph{\DUrole{n}{continuous\_inputs}}, \emph{\DUrole{n}{options}}}{}
This function
Args:
Return:

\end{fulllineitems}

\index{\_create\_grid() (nloed.design.Design method)@\spxentry{\_create\_grid()}\spxextra{nloed.design.Design method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.design.Design._create_grid}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_create\_grid}}}{\emph{\DUrole{n}{input\_names}}, \emph{\DUrole{n}{input\_candidates}}, \emph{\DUrole{n}{constraints}}}{}
This function
Args:
Return:

\end{fulllineitems}

\index{\_sort\_inputs() (nloed.design.Design method)@\spxentry{\_sort\_inputs()}\spxextra{nloed.design.Design method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{nloed:nloed.design.Design._sort_inputs}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{\_sort\_inputs}}}{\emph{\DUrole{n}{newrow}}, \emph{\DUrole{n}{rows}}, \emph{\DUrole{n}{rowpntr}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{colpntr}\DUrole{o}{=}\DUrole{default_value}{0}}}{}
\end{fulllineitems}


\end{fulllineitems}



\chapter{Index}
\label{\detokenize{index:index}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{n}
\item\relax\sphinxstyleindexentry{nloed.design}\sphinxstyleindexpageref{nloed:\detokenize{module-nloed.design}}
\item\relax\sphinxstyleindexentry{nloed.model}\sphinxstyleindexpageref{nloed:\detokenize{module-nloed.model}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}